!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@fr0st/ui"),require("@fr0st/query")):"function"==typeof define&&define.amd?define(["exports","@fr0st/ui","@fr0st/query"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).UI=t.UI||{},t.UI,t.fQuery)}(this,(function(t,e,s){"use strict";class r extends e.BaseComponent{constructor(t,e){super(t,e),this._options.container?this._container=s.findOne(this._options.container):this._container=s.closest(this._node,":not(.form-input):not(.input-group)"),this._render(),this._refresh(),this._events()}dispose(){s.remove(this._progress),s.removeEvent(this._node,"input.ui.passwordstrength"),s.removeAttribute(this._node,"aria-describedby"),this._container=null,this._progress=null,this._progressBar=null,super.dispose()}getStrength(){const t=s.getValue(this._node);return this.constructor.getStrength(t)}}function n(t,e){const s=[];let r=[];for(let n=0;n<e.length-1;n++){const o=e[n],i=e[n+1],h=i-o,a=t[o],c=t[i],g=c.charCodeAt(0)-a.charCodeAt(0);1===h&&1===g?(r.length||r.push(a),r.push(c)):r.length&&(s.push(r),r=[])}return r.length&&s.push(r),s}r.defaults={levels:[{score:0,class:"text-bg-danger",text:"Very Weak"},{score:20,class:"text-bg-danger",text:"Weak"},{score:40,class:"text-bg-warning",text:"Normal"},{score:60,class:"text-bg-success",text:"Strong"},{score:80,class:"text-bg-success",text:"Very Strong"}],container:null,striped:!1},r.classes={progress:"progress mt-2",progressBar:"progress-bar",progressBarStriped:"progress-bar-striped"},r.getStrength=function(t){t.match(/^password/i)&&(t=t.substring(8));const e=t.length;let r=0;e&&(r+=6*e);const o=[],i=[],h=[],a=[],c={};for(let s=0;s<e;s++){const e=t[s],r=e.charCodeAt(0);r>=48&&r<=57?h.push(s):r>=65&&r<=90?o.push(s):r>=97&&r<=122?i.push(s):a.push(s),e in c||(c[e]=0),c[e]++}o.length!==e&&i.length!==e&&(o.length&&(r+=e-o.length),i.length&&(r+=e-i.length)),h.length!==e&&(r+=3*h.length),r+=6*a.length;for(const t of[h,a])r+=3*t.filter((t=>t&&t!==e-1)).length;h.length||a.length||(r-=e),o.length||i.length||a.length||(r-=e),a.length||(r-=e);const g=Object.values(c).reduce(((t,e)=>t+e-1),0);if(g>0&&(r-=g),e>=2){const e=t.matchAll(/(.)\1+/g);for(const t of e)r-=3*Math.min(t[0].length,12);const s=t.toLowerCase(),a=n(s,o.concat(i));for(const t of a)t.length>2&&(r-=3*Math.min(t.length-2,16));const c=n(s,h);for(const t of c)t.length>2&&(r-=3*Math.min(t.length-2,16))}return s._clamp(r,0,100)};const o=r.prototype;o._events=function(){s.addEvent(this._node,"input.ui.passwordstrength",(t=>{this._refresh()}))},o._refresh=function(){const t=this.getStrength();let e;for(const s of this._options.levels){if(t<s.score)break;e=s}s.setStyle(this._progressBar,{width:`${t}%`}),s.setAttribute(this._progressBar,{class:this.constructor.classes.progressBar,"aria-valuenow":t}),s.addClass(this._progressBar,e.class),this._options.striped&&s.addClass(this._progressBar,this.constructor.classes.progressBarStriped),e.text&&s.setText(this._progressBar,e.text)},o._render=function(){this._progress=s.create("div",{class:this.constructor.classes.progress});const t=e.generateId("password-strength");this._progressBar=s.create("div",{attributes:{id:t,role:"progressbar","aria-valuemin":0,"aria-valuemax":100}}),s.append(this._progress,this._progressBar),s.append(this._container,this._progress),s.setAttribute(this._node,{"aria-describedby":t})},e.initComponent("passwordstrength",r),t.PasswordStrength=r}));