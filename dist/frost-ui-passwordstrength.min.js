!function(t,s){"object"==typeof exports&&"undefined"!=typeof module?s(exports,require("@fr0st/ui"),require("@fr0st/query")):"function"==typeof define&&define.amd?define(["exports","@fr0st/ui","@fr0st/query"],s):s((t="undefined"!=typeof globalThis?globalThis:t||self).UI=t.UI||{},t.UI,t.fQuery)}(this,(function(t,s,e){"use strict";class r extends s.BaseComponent{constructor(t,s){super(t,s),this._options.container?this._container=e.findOne(this._options.container):this._container=e.closest(this._node,":not(.form-input):not(.input-group)"),this._render(),this._refresh(),this._events()}dispose(){e.remove(this._progress),e.removeEvent(this._node,"input.ui.passwordstrength"),this._container=null,this._progress=null,this._progressBar=null,super.dispose()}getStrength(){const t=e.getValue(this._node);return this.constructor.getStrength(t)}}function n(t,s){const e=[];let r=[];for(let n=0;n<s.length-1;n++){const o=s[n],i=s[n+1],h=i-o,a=t[o],c=t[i],l=c.charCodeAt(0)-a.charCodeAt(0);1===h&&1===l?(r.length||r.push(a),r.push(c)):r.length&&(e.push(r),r=[])}return r.length&&e.push(r),e}r.defaults={levels:[{score:0,class:"text-bg-danger",text:"Very Weak"},{score:20,class:"text-bg-danger",text:"Weak"},{score:40,class:"text-bg-warning",text:"Normal"},{score:60,class:"text-bg-success",text:"Strong"},{score:80,class:"text-bg-success",text:"Very Strong"}],container:null,striped:!1},r.classes={progress:"progress mt-2",progressBar:"progress-bar",progressBarStriped:"progress-bar-striped"},r.getStrength=function(t){t.match(/^password/i)&&(t=t.substring(8));const s=t.length;let r=0;s&&(r+=6*s);const o=[],i=[],h=[],a=[],c={};for(let e=0;e<s;e++){const s=t[e],r=s.charCodeAt(0);r>=48&&r<=57?h.push(e):r>=65&&r<=90?o.push(e):r>=97&&r<=122?i.push(e):a.push(e),s in c||(c[s]=0),c[s]++}o.length!==s&&i.length!==s&&(o.length&&(r+=s-o.length),i.length&&(r+=s-i.length)),h.length!==s&&(r+=3*h.length),r+=6*a.length;for(const t of[h,a])r+=3*t.filter((t=>t&&t!==s-1)).length;h.length||a.length||(r-=s),o.length||i.length||a.length||(r-=s),a.length||(r-=s);const l=Object.values(c).reduce(((t,s)=>t+s-1),0);if(l>0&&(r-=l),s>=2){const s=t.matchAll(/(.)\1+/g);for(const t of s)r-=3*Math.min(t[0].length,12);const e=t.toLowerCase(),a=n(e,o.concat(i));for(const t of a)t.length>2&&(r-=3*Math.min(t.length-2,16));const c=n(e,h);for(const t of c)t.length>2&&(r-=3*Math.min(t.length-2,16))}return e._clamp(r,0,100)};const o=r.prototype;o._events=function(){e.addEvent(this._node,"input.ui.passwordstrength",(t=>{this._refresh()}))},o._refresh=function(){const t=this.getStrength();let s;for(const e of this._options.levels){if(t<e.score)break;s=e}e.setStyle(this._progressBar,{width:`${t}%`}),e.setAttribute(this._progressBar,{class:this.constructor.classes.progressBar,"aria-valuenow":t}),e.addClass(this._progressBar,s.class),this._options.striped&&e.addClass(this._progressBar,this.constructor.classes.progressBarStriped),s.text&&e.setText(this._progressBar,s.text)},o._render=function(){this._progress=e.create("div",{class:this.constructor.classes.progress}),this._progressBar=e.create("div",{attributes:{role:"progressbar","aria-valuemin":0,"aria-valuemax":100}}),e.append(this._progress,this._progressBar),e.append(this._container,this._progress)},s.initComponent("passwordstrength",r),t.PasswordStrength=r}));